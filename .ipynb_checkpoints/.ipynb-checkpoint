{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# New York Living Local\n",
    "----\n",
    "\n",
    "#### Note\n",
    "* We will be using Google Maps to locate points of interest with New York City\n",
    "    * DataFrame will be created\n",
    "    * Data Clean up to be performed\n",
    "    * Data will be stored in tables of Postgress DB"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Dependencies and Setup\n",
    "\n",
    "import pandas as pd\n",
    "import requests\n",
    "import time\n",
    "import os\n",
    "from datetime import date\n",
    "import json\n",
    "from pprint import pprint\n",
    "from sqlalchemy import create_engine\n",
    "\n",
    "# Import API key\n",
    "from api_keys import api_key\n",
    "\n",
    "curdate = date.today().strftime(\"%m/%d/%Y\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Perform API Calls\n",
    "* Perform a weather check on each city using a series of successive API calls.\n",
    "* Include a print log of each city as it'sbeing processed (with the city number and city name).\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "#API Calls\n",
    "# Save config information and parameters\n",
    "#url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?query=new+york+city+point+of+interest&language=en&key=AIzaSyCZhPzDNVZW7U_8SbGMI2IrXpcK9gIio58\"\n",
    "city_var = \"new+york\"\n",
    "\n",
    "params = {\n",
    "    \"query\": f\"{city_var}+point+of+interest\",\n",
    "    \"key\": api_key,\n",
    "    \"language\": \"en\"\n",
    "}\n",
    "\n",
    "url = \"https://maps.googleapis.com/maps/api/place/textsearch/json?\"\n",
    "\n",
    "response = requests.get(url, params).json()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Convert Raw Data to DataFrame\n",
    "* Export the city data into a .csv.\n",
    "* Display the DataFrame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'html_attributions': [],\n",
      " 'next_page_token': 'CpQCBgEAANkuJswZuzT2dcVsh6uo9i7YLZfFL5vrmzKJxZ_TAumWMj5YJOlDGaIgyw2ZYl-GQk9OQzR6WaJOIyA8APZHO_ahAfNoxiCugvuxOZPGK-geEo-IvSp2H5iIKhqcpFAUWDVW83ndcXZunOCfXN6azcWSGN_xPrNdkkxgL61Vtd37qz1P9piSBAZYyKw5JdMDjhl864iuUtMzDF1G8fNALWs_L7CfozuSZWRZ-EWfqzbHgVH3swnwBasNFUDDyFszxqcXppP6LUpy4Ek0o0c6t4qdT2X3CJcFbYXUP6q-GxlX7gDHE5VdRA1VTWWGNj56006iAmh_EpWU1A9zmZAtXWSEVa6h1YsZMkYO4TlR4gZTEhCJIxcbXsRVhcrGTjj5YkqCGhS7O_oQ3bhVG9MJym7C0gjHkZGpZw',\n",
      " 'results': [{'formatted_address': '10 South St, New York, NY 10004, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.6919879,\n",
      "                                        'lng': -74.01599499999999},\n",
      "                           'viewport': {'northeast': {'lat': 40.69333772989273,\n",
      "                                                      'lng': -74.01464517010727},\n",
      "                                        'southwest': {'lat': 40.69063807010728,\n",
      "                                                      'lng': -74.0173448298927}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/museum-71.png',\n",
      "              'id': 'e2568410beb651c76959c8c706e1d771fc316fa9',\n",
      "              'name': 'Governors Island National Monument',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 4897,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/106490258821111884682\">Mark '\n",
      "                                                'Furmanik</a>'],\n",
      "                          'photo_reference': 'CmRaAAAA4eurt9cKgbHsY02cnEneuBTiMMMShAQptuJmdsTZ6g1buh_0u09aKly11ogYgbY35e8rhHiZ0BJQSa6qfV-kPRhXjFaDIb6ts8oiSF5gG33OzjqsOysrI3yapAr7KRlYEhAHPdCFxyVI0i1kqOSHHBJ2GhQKorltsNbw1ANgCI4JVAsqFuydRQ',\n",
      "                          'width': 3266}],\n",
      "              'place_id': 'ChIJ2_ey6W9awokRxng4fzLDbPo',\n",
      "              'plus_code': {'compound_code': 'MXRM+QJ New York',\n",
      "                            'global_code': '87G7MXRM+QJ'},\n",
      "              'rating': 4.6,\n",
      "              'reference': 'ChIJ2_ey6W9awokRxng4fzLDbPo',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 2675},\n",
      "             {'formatted_address': 'W 122nd St & Riverside Dr, New York, NY '\n",
      "                                   '10027, United States',\n",
      "              'geometry': {'location': {'lat': 40.8134045, 'lng': -73.9630671},\n",
      "                           'viewport': {'northeast': {'lat': 40.81479342989272,\n",
      "                                                      'lng': -73.96171487010727},\n",
      "                                        'southwest': {'lat': 40.81209377010728,\n",
      "                                                      'lng': -73.96441452989272}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_recreational-71.png',\n",
      "              'id': '733dc3338625663c853d87af545babc054c43006',\n",
      "              'name': 'General Grant National Memorial',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 4000,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/109490048016942159532\">Roel '\n",
      "                                                'Schreurs</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAbLWH_BbqQWF2cqZh0K5wD_wGzlsQZ49jdlbswHHod9XX-DNWLUn_7r49EDYQLhk3YjX_nVUALhsXRSH154sAjny7rj8y9jcgnc7J4DpgDFtk46FyyHgh3mng_AbOXyjQEhBonDtg9IZnBcu3TvxO9VA5GhTahoK66dDpN0Ai6xbDDLQSsSMEWQ',\n",
      "                          'width': 6016}],\n",
      "              'place_id': 'ChIJoxqn-kD2wokRLvhOLfAneU8',\n",
      "              'plus_code': {'compound_code': 'R27P+9Q New York',\n",
      "                            'global_code': '87G8R27P+9Q'},\n",
      "              'rating': 4.5,\n",
      "              'reference': 'ChIJoxqn-kD2wokRLvhOLfAneU8',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'park',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 697},\n",
      "             {'formatted_address': '414 W 141st St, New York, NY 10031, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.8213537, 'lng': -73.9473103},\n",
      "                           'viewport': {'northeast': {'lat': 40.82289047989271,\n",
      "                                                      'lng': -73.94589007010728},\n",
      "                                        'southwest': {'lat': 40.82019082010727,\n",
      "                                                      'lng': -73.94858972989272}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': '7fdf8be4d494f647a65700f36b00fa077e4f68d3',\n",
      "              'name': 'Alexander Hamilton Grange National Memorial',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3024,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/113244420116672845924\">Tim '\n",
      "                                                'Sneath</a>'],\n",
      "                          'photo_reference': 'CmRaAAAASX4Cj7sXLOtVFTWpYEhXSCwnd7SUdhZBN1xtuOr1mjJqJNy6x0-uumnBpgI6x1CFyJ1Rb2aKeV4--s8FA9npQ7lem8PBGs0AJUdd6UnuOMNuWt4VObTTgOaCjXrl77K5EhBYelMx_C0UEsJtPcRtv9hQGhSd6-Ob1oNNm1JFqyOwMjB3g9bN7Q',\n",
      "                          'width': 4032}],\n",
      "              'place_id': 'ChIJ5wFJxXr2wokRQEmdWil_bEw',\n",
      "              'plus_code': {'compound_code': 'R3C3+G3 New York',\n",
      "                            'global_code': '87G8R3C3+G3'},\n",
      "              'rating': 4.5,\n",
      "              'reference': 'ChIJ5wFJxXr2wokRQEmdWil_bEw',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'museum',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 529},\n",
      "             {'formatted_address': 'New York, NY 10004, United States',\n",
      "              'geometry': {'location': {'lat': 40.6892494,\n",
      "                                        'lng': -74.04450039999999},\n",
      "                           'viewport': {'northeast': {'lat': 40.71814749999999,\n",
      "                                                      'lng': -73.99872490000001},\n",
      "                                        'southwest': {'lat': 40.6796167,\n",
      "                                                      'lng': -74.05975889999998}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': '5a0d7e67078e35af0c456a277df9ffba7c1e4da6',\n",
      "              'name': 'Statue of Liberty National Monument',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 4032,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/104615317245344911843\">Brett '\n",
      "                                                'Pyle</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAew-sfNAOYDLwO4tyOjqsF8Gk9Cwjhj4pAvg5iKLd7gvVPBcASklmtskeY__HY-X_EyT6CuUNZwEiRXXEyVAxfC6Cd4xW8qr3Ft_Y_j0ZDaTMYBQ1Myp6nMZ622wvf0bEEhAWY8CnTQEl8iP4jfr84czpGhSpHGBF3Wo0zf-amM27IQlRwRFhjg',\n",
      "                          'width': 3024}],\n",
      "              'place_id': 'ChIJPTacEpBQwokRKwIlDXelxkA',\n",
      "              'plus_code': {'compound_code': 'MXQ4+M5 New York',\n",
      "                            'global_code': '87G7MXQ4+M5'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJPTacEpBQwokRKwIlDXelxkA',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'park',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 66920},\n",
      "             {'formatted_address': '89 E 42nd St, New York, NY 10017, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.7525935, 'lng': -73.9767279},\n",
      "                           'viewport': {'northeast': {'lat': 40.75371032989272,\n",
      "                                                      'lng': -73.97479917010729},\n",
      "                                        'southwest': {'lat': 40.75101067010728,\n",
      "                                                      'lng': -73.97749882989272}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/shopping-71.png',\n",
      "              'id': '096265fefe8d7d8c6f99699e4409d5aa84b17116',\n",
      "              'name': 'Grand Central Market',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3006,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/115125443427453367948\">Richard '\n",
      "                                                'Fife</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAZSLnR57MqONdFTl9OAI-ooTRxk4Oq_q6bt5kR5VXHxxqDJ02mLvcwTIr_frDA7dMIrXGwF6KnoWDgzZn33mQG5G35DBdZ0u7Te9LxhSMGUDGzBLbY4NLtNawzpEqpDtuEhAf3sECFzm8D6eadmtP0iHsGhQd-sNdOykv5V65vtO0MCMOGBvg_A',\n",
      "                          'width': 5344}],\n",
      "              'place_id': 'ChIJj9zIOgJZwokRuuxV79u6_nU',\n",
      "              'plus_code': {'compound_code': 'Q23F+28 New York',\n",
      "                            'global_code': '87G8Q23F+28'},\n",
      "              'rating': 4.5,\n",
      "              'reference': 'ChIJj9zIOgJZwokRuuxV79u6_nU',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 1060},\n",
      "             {'formatted_address': 'Water St &, State St, New York, NY 10004, '\n",
      "                                   'United States',\n",
      "              'geometry': {'location': {'lat': 40.70218089999999,\n",
      "                                        'lng': -74.01499749999999},\n",
      "                           'viewport': {'northeast': {'lat': 40.70350567989272,\n",
      "                                                      'lng': -74.01319335},\n",
      "                                        'southwest': {'lat': 40.70080602010728,\n",
      "                                                      'lng': -74.01593035}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': '2fad60c4a269d0c16dd2836b031c4c5161628550',\n",
      "              'name': 'SeaGlass Carousel',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 4000,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/103629638615749277925\">Hugo '\n",
      "                                                'Cruz</a>'],\n",
      "                          'photo_reference': 'CmRaAAAALQey0XNzLJk2y1knvKwunmZ7bJlXB3WQXjGrZeZ3bT21TxuPGX1_lP4N6j7oTdkJkGz5jLsFEukW3ohyhUO0FwdihBKhBGkNJguW2aG3p0tGGcPUxHYdZ-EG1JdDoTYxEhCNVewXgnwLKcUJp-YjllIMGhTKhQJ4k3tkZg4iS3iAdkuodTiz7w',\n",
      "                          'width': 6000}],\n",
      "              'place_id': 'ChIJryEQYRJawokR_bfRRa_lPqs',\n",
      "              'plus_code': {'compound_code': 'PX2P+V2 New York',\n",
      "                            'global_code': '87G7PX2P+V2'},\n",
      "              'rating': 4.5,\n",
      "              'reference': 'ChIJryEQYRJawokR_bfRRa_lPqs',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 497},\n",
      "             {'formatted_address': 'New York, NY, United States',\n",
      "              'geometry': {'location': {'lat': 40.7828647, 'lng': -73.9653551},\n",
      "                           'viewport': {'northeast': {'lat': 40.81804399999999,\n",
      "                                                      'lng': -73.9339825},\n",
      "                                        'southwest': {'lat': 40.7473416,\n",
      "                                                      'lng': -73.9970305}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_recreational-71.png',\n",
      "              'id': 'c9bcef33f0cc85eda31f1c7444e9b1a3b82c9a9f',\n",
      "              'name': 'Central Park',\n",
      "              'opening_hours': {'open_now': True},\n",
      "              'photos': [{'height': 2448,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/104674184720700703454\">Gustavo '\n",
      "                                                'Brenes</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAXsY_ZN73tL_2aA4AsAnZATsJDjQEBNED1OrCMXS5BoDhJTqvKdw1fIHyRIFZKMnNJ1TosOfGbju-TUmKVD6Zd0x_3f4kRuOwxdumVX_KICc-SGz21PPbpKtiWYp26llaEhCHpA7KZegEZd3tY8UDHOrDGhQ-RuUCP9RdIbqURt9x1Ad-CMvgiw',\n",
      "                          'width': 3264}],\n",
      "              'place_id': 'ChIJ4zGFAZpYwokRGUGph3Mf37k',\n",
      "              'plus_code': {'compound_code': 'Q2MM+4V New York',\n",
      "                            'global_code': '87G8Q2MM+4V'},\n",
      "              'rating': 4.8,\n",
      "              'reference': 'ChIJ4zGFAZpYwokRGUGph3Mf37k',\n",
      "              'types': ['park',\n",
      "                        'tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 194571},\n",
      "             {'formatted_address': '20 W 34th St, New York, NY 10001, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.7484405,\n",
      "                                        'lng': -73.98566439999999},\n",
      "                           'viewport': {'northeast': {'lat': 40.74971142989272,\n",
      "                                                      'lng': -73.98392452010728},\n",
      "                                        'southwest': {'lat': 40.74701177010728,\n",
      "                                                      'lng': -73.98662417989271}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': 'bc232d2422e7068b2a2ffb314f02e3733dd47796',\n",
      "              'name': 'Empire State Building',\n",
      "              'opening_hours': {'open_now': True},\n",
      "              'photos': [{'height': 720,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/117951087160583633334\">Empire '\n",
      "                                                'State Building</a>'],\n",
      "                          'photo_reference': 'CmRaAAAA-CUSotg1IimaSVRtyc6RDUizQf1ouaK9P-9HDrkm-e7NqQPrhDMnLqqVCwsMY1Zy6j6awF3nb50j6_dTLZdf7g7oKAH_d5rzbpMhWJy6Jvt396IWZYDYMDZzH955XRyeEhDg0fiVxk0ZsrGwqDsm50-fGhQgs4LeauT2QIG5M0TyAiDtrA1iiA',\n",
      "                          'width': 1280}],\n",
      "              'place_id': 'ChIJaXQRs6lZwokRY6EFpJnhNNE',\n",
      "              'plus_code': {'compound_code': 'P2X7+9P New York',\n",
      "                            'global_code': '87G8P2X7+9P'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJaXQRs6lZwokRY6EFpJnhNNE',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 70860},\n",
      "             {'formatted_address': 'Brooklyn Bridge, New York, NY 10038, '\n",
      "                                   'United States',\n",
      "              'geometry': {'location': {'lat': 40.7060855, 'lng': -73.9968643},\n",
      "                           'viewport': {'northeast': {'lat': 40.7192285,\n",
      "                                                      'lng': -73.9812363},\n",
      "                                        'southwest': {'lat': 40.6886497,\n",
      "                                                      'lng': -74.0112811}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': 'c1ac50eff9bb8e9505c59c69c4523ae94c4126fc',\n",
      "              'name': 'Brooklyn Bridge',\n",
      "              'photos': [{'height': 2618,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/108804069346240761751\">Marijn '\n",
      "                                                'van der Woude</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAhRGyIlQdXSYcsGuHIkFckR-ABuJMLv30Qd9DrjfrBnRzu9Ym4UThlaLR2ClnUZB0GaNSGJbY7h8ANF7cBB2STH0UhGxaYiHO97fSApOMUI4fqwqWgNzGBM29QTZQNV9GEhCmPLd2OylKgr51DZ1XYhIxGhTE9zYeSgIKjY_Yrmgi95RdZKS9Ew',\n",
      "                          'width': 4656}],\n",
      "              'place_id': 'ChIJK3vOQyNawokRXEa9errdJiU',\n",
      "              'plus_code': {'compound_code': 'P243+C7 New York',\n",
      "                            'global_code': '87G8P243+C7'},\n",
      "              'rating': 4.8,\n",
      "              'reference': 'ChIJK3vOQyNawokRXEa9errdJiU',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 43973},\n",
      "             {'formatted_address': 'New York, NY 10011, United States',\n",
      "              'geometry': {'location': {'lat': 40.7479925, 'lng': -74.0047649},\n",
      "                           'viewport': {'northeast': {'lat': 40.75890824999998,\n",
      "                                                      'lng': -73.99853175},\n",
      "                                        'southwest': {'lat': 40.73287364999999,\n",
      "                                                      'lng': -74.01141114999999}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_recreational-71.png',\n",
      "              'id': '72dc79d023feec77725d7336e7c46fee27805319',\n",
      "              'name': 'The High Line',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3267,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/105487997458497097901\">Александр '\n",
      "                                                'Иванов</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAotJeZ-BM6WsBoTqLNlKPx_ls2rxm1r1TgPgSlaNfJ4NF6jSEzEi4kp-3rrk6GJ9qAlecEX7eeKtPNGuHR6M8sFgXUQ_7AeKGrC70toiJg43fhR__yugdBuVV30Tpscf7EhA-k2aYl79YMjEBMeU8WyM_GhT1xq4POuXtwMPS-9oe8De8Uw_jXw',\n",
      "                          'width': 4895}],\n",
      "              'place_id': 'ChIJ5bQPhMdZwokRkTwKhVxhP1g',\n",
      "              'plus_code': {'compound_code': 'PXXW+53 New York',\n",
      "                            'global_code': '87G7PXXW+53'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJ5bQPhMdZwokRkTwKhVxhP1g',\n",
      "              'types': ['park',\n",
      "                        'tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 38797},\n",
      "             {'formatted_address': '5th Ave, New York, NY 10022, United States',\n",
      "              'geometry': {'location': {'lat': 40.7584653,\n",
      "                                        'lng': -73.97599269999999},\n",
      "                           'viewport': {'northeast': {'lat': 40.75987907989272,\n",
      "                                                      'lng': -73.97453474999999},\n",
      "                                        'southwest': {'lat': 40.75717942010727,\n",
      "                                                      'lng': -73.97777375}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/worship_general-71.png',\n",
      "              'id': 'acf24f96362bdabb64807f6c17cba8bb1d5b738a',\n",
      "              'name': \"St. Patrick's Cathedral\",\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 4032,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/103645577548184875978\">Sahar '\n",
      "                                                'Sadjedi</a>'],\n",
      "                          'photo_reference': 'CmRaAAAA-8ZUnzBMVYUKxI2bd6bGMsnv5J_NsfHzkcGfP1pZE1tMDEIwQ_ByJHWvGhud_QyrCLodDTCLEOLSsqg28r_0JZGoP9c0AppmH8lP_DJzOJ1xOkqhPa0Rcf9wd6ZWZ8ZmEhC8SaHeL56KI_ZgNyPtW7p8GhSKj2heFutvRbzMrLMCwlgTJY8dAg',\n",
      "                          'width': 3024}],\n",
      "              'place_id': 'ChIJUW4vEPxYwokRW6o24DU0YIg',\n",
      "              'plus_code': {'compound_code': 'Q25F+9J New York',\n",
      "                            'global_code': '87G8Q25F+9J'},\n",
      "              'rating': 4.8,\n",
      "              'reference': 'ChIJUW4vEPxYwokRW6o24DU0YIg',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'church',\n",
      "                        'place_of_worship',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 24222},\n",
      "             {'formatted_address': '30 Rockefeller Plaza, New York, NY 10112, '\n",
      "                                   'United States',\n",
      "              'geometry': {'location': {'lat': 40.7591205, 'lng': -73.9795267},\n",
      "                           'viewport': {'northeast': {'lat': 40.76060317989272,\n",
      "                                                      'lng': -73.97801842010728},\n",
      "                                        'southwest': {'lat': 40.75790352010728,\n",
      "                                                      'lng': -73.98071807989271}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': 'e05462d15e6f301386934e30734e0c6d39636b95',\n",
      "              'name': 'Top of the Rock',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 1440,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/111639147317210538021\">Christopher '\n",
      "                                                'Castro</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAtRWomWA9ZIqeR2Aels3XWK7VgAVxE14AfT4AUHDbMEb8S3J64oB89O8npGmf3IdnEb7Ept2GxktFi76oYjDOTalrqkFK7jo0AceIuCHpY7KytgqO6ym7hFvEQM_j9wtlEhBaeeQWmUZLYmEKtokCng_bGhS-tCOcPoaXdBaxAka2qUYNHsaxTw',\n",
      "                          'width': 2496}],\n",
      "              'place_id': 'ChIJe7vKMf9YwokRIMYfDz7iF9o',\n",
      "              'plus_code': {'compound_code': 'Q25C+J5 New York',\n",
      "                            'global_code': '87G8Q25C+J5'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJe7vKMf9YwokRIMYfDz7iF9o',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 34969},\n",
      "             {'formatted_address': '45 Rockefeller Plaza, New York, NY 10111, '\n",
      "                                   'United States',\n",
      "              'geometry': {'location': {'lat': 40.7587402, 'lng': -73.9786736},\n",
      "                           'viewport': {'northeast': {'lat': 40.75982057989272,\n",
      "                                                      'lng': -73.97721755},\n",
      "                                        'southwest': {'lat': 40.75712092010727,\n",
      "                                                      'lng': -73.98132935000001}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': 'af4e108e284a34cb052d51eb1eda880f18ff9d88',\n",
      "              'name': 'Rockefeller Center',\n",
      "              'opening_hours': {'open_now': True},\n",
      "              'photos': [{'height': 2248,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/109009857293107840121\">Jose '\n",
      "                                                'Luis Zarate</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAmOARQNzfksQrUwfQx2V6Kh5INXeDZ2d_WBb76_k773WGdElprm9hHv0yLRKRFjxQROYz0C6i77IDZkBB2FyM_yFOpC2Qt3CtMTIakDG8MmFNIbh7UVTyW24fUqmwia1gEhD4fSsUyHLtydwXZ3vofM4YGhT2qLZzy3uIDO6J8pdBoEhFp-RSCw',\n",
      "                          'width': 4000}],\n",
      "              'place_id': 'ChIJ9U1mz_5YwokRosza1aAk0jM',\n",
      "              'plus_code': {'compound_code': 'Q25C+FG New York',\n",
      "                            'global_code': '87G8Q25C+FG'},\n",
      "              'rating': 4.6,\n",
      "              'reference': 'ChIJ9U1mz_5YwokRosza1aAk0jM',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 115783},\n",
      "             {'formatted_address': '1000 5th Ave, New York, NY 10028, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.7794366, 'lng': -73.963244},\n",
      "                           'viewport': {'northeast': {'lat': 40.78025357989272,\n",
      "                                                      'lng': -73.96137637010729},\n",
      "                                        'southwest': {'lat': 40.77755392010728,\n",
      "                                                      'lng': -73.96407602989272}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/museum-71.png',\n",
      "              'id': 'f732f202150af1f14ae8a057a1014ceea6b33fc4',\n",
      "              'name': 'The Metropolitan Museum of Art',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3024,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/115967679611787063919\">Richard '\n",
      "                                                'Stark</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAvgBOuXGuJgiXAylGjDlz2SDPwkho4PvmKs67eIX1BbsqjGPWDBGCRdIt1A6oN8lDoDf0YR0kKjCbro_Rr-pXrhRhZdf4ysW8WJRX7HAF-5Sm_dRQ4PBI_KKSxV3yCKllEhAlUUbEPaukriHvJErSiLGTGhS0NZg7qgSeIyW-1ELWqDgR_WFM8g',\n",
      "                          'width': 4032}],\n",
      "              'place_id': 'ChIJb8Jg9pZYwokR-qHGtvSkLzs',\n",
      "              'plus_code': {'compound_code': 'Q2HP+QP New York',\n",
      "                            'global_code': '87G8Q2HP+QP'},\n",
      "              'price_level': 3,\n",
      "              'rating': 4.8,\n",
      "              'reference': 'ChIJb8Jg9pZYwokR-qHGtvSkLzs',\n",
      "              'types': ['art_gallery',\n",
      "                        'tourist_attraction',\n",
      "                        'museum',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 55252},\n",
      "             {'formatted_address': 'Pier 86, W 46th St, New York, NY 10036, '\n",
      "                                   'United States',\n",
      "              'geometry': {'location': {'lat': 40.7645266,\n",
      "                                        'lng': -73.99960759999999},\n",
      "                           'viewport': {'northeast': {'lat': 40.76578527989272,\n",
      "                                                      'lng': -73.99790007010728},\n",
      "                                        'southwest': {'lat': 40.76308562010728,\n",
      "                                                      'lng': -74.00059972989273}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/museum-71.png',\n",
      "              'id': '6bb43beb2047e4db91e332d24782460ccf8194c2',\n",
      "              'name': 'Intrepid Sea, Air & Space Museum',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3024,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/110574460124929713793\">Zaha '\n",
      "                                                'A</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAY2G3AemzefGy91EZ2Epfk49xw6k1pA1AivvoDDuYmr3w_WFKFx7VRc87gQnJ7KbzUSu3azoENdADd6Ir4-v09aX36-YYUb7IWHSx65oWD8Glx1qd062aznFriKfUp3K3EhCisw0kyyv9uIMtD23N1V7FGhQYm-zEriUxyQLF0H-1T4M2kRsUkw',\n",
      "                          'width': 4032}],\n",
      "              'place_id': 'ChIJnxlg1U5YwokR8T90UrZiIwI',\n",
      "              'plus_code': {'compound_code': 'Q272+R5 New York',\n",
      "                            'global_code': '87G8Q272+R5'},\n",
      "              'rating': 4.6,\n",
      "              'reference': 'ChIJnxlg1U5YwokR8T90UrZiIwI',\n",
      "              'types': ['museum',\n",
      "                        'tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 26027},\n",
      "             {'formatted_address': '285 Fulton St, New York, NY 10006, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.7133444, 'lng': -74.0133677},\n",
      "                           'viewport': {'northeast': {'lat': 40.71436417989273,\n",
      "                                                      'lng': -74.01215482010727},\n",
      "                                        'southwest': {'lat': 40.71166452010728,\n",
      "                                                      'lng': -74.0148544798927}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': '48cd459142d91a750ab1ac00141e799d2a7c1bfb',\n",
      "              'name': 'One World Observatory',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3888,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/101181986155032856789\">david '\n",
      "                                                'jackson</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAQOyFyEVn0JUqxgfR4ZJ5JZMD5SYFtRenkjpcz7l86IWEhW4BjCNCskD9023fWusbLh7QYJTMF-qG2NKENI2Th0A1zwKINg5uGCZQnq4wWVOLFqAxJQRcCkV83q8eFrUSEhAjvG0z6NRsLrBzjLi4GeuWGhRNIpqk4avJwEC7hGR0-MPfILvS7A',\n",
      "                          'width': 5456}],\n",
      "              'place_id': 'ChIJTWE_0BtawokRVJNGH5RS448',\n",
      "              'plus_code': {'compound_code': 'PX7P+8M New York',\n",
      "                            'global_code': '87G7PX7P+8M'},\n",
      "              'price_level': 3,\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJTWE_0BtawokRVJNGH5RS448',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 13670},\n",
      "             {'formatted_address': '1260 6th Ave, New York, NY 10020, United '\n",
      "                                   'States',\n",
      "              'geometry': {'location': {'lat': 40.75997599999999,\n",
      "                                        'lng': -73.9799772},\n",
      "                           'viewport': {'northeast': {'lat': 40.76128112989272,\n",
      "                                                      'lng': -73.97878962010728},\n",
      "                                        'southwest': {'lat': 40.75858147010728,\n",
      "                                                      'lng': -73.98148927989271}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_business-71.png',\n",
      "              'id': '89dd7f0c82efc14f18954f8abf2925515037927a',\n",
      "              'name': 'Radio City Music Hall',\n",
      "              'photos': [{'height': 4032,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/105061948464149774244\">walter '\n",
      "                                                'thompson</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAmzPHUuasJ7a5-14xlROEp4gOwjMF55_4BHiBhqgNckAhBjxktN4twyx8DWVzNoMOPrpJttYmHV21GI-x-3w_jay49gMZDvboxg2XEk3nwPTsOTpIpdDiJKOqAROyvMnGEhCTZm4lB3Yw4l19vjRBhNENGhTftrLwr75uiDnreNNyDVXPZF1GLQ',\n",
      "                          'width': 3024}],\n",
      "              'place_id': 'ChIJPS8b1vhYwokRldqq2YHmxJI',\n",
      "              'plus_code': {'compound_code': 'Q25C+X2 New York',\n",
      "                            'global_code': '87G8Q25C+X2'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJPS8b1vhYwokRldqq2YHmxJI',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 16414},\n",
      "             {'formatted_address': 'New York, NY 10018, United States',\n",
      "              'geometry': {'location': {'lat': 40.7535965, 'lng': -73.9832326},\n",
      "                           'viewport': {'northeast': {'lat': 40.755549,\n",
      "                                                      'lng': -73.98133884999999},\n",
      "                                        'southwest': {'lat': 40.75198299999999,\n",
      "                                                      'lng': -73.98575824999999}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_recreational-71.png',\n",
      "              'id': 'f450a4290a3af961748f0eb93931479d2898e990',\n",
      "              'name': 'Bryant Park',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 2432,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/110908076193635977050\">Akshat '\n",
      "                                                'R</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAy_W3BKp5CcYDvojBV4XMI9jZLHPjHHBEuttaLAVGlk9v6kEO2-Mt_ZERejTLTLoz4dmPv_HZNYioTyTFhhP9uSbkh9m99g6E7Mki_qvxzIrt3rK9BWrWWud2rSXlOoWpEhA11YVxS3RmCjvQ_rfwmEsjGhQLVsmH5XdJ6Z5j5x8Ur5zZtk2OsA',\n",
      "                          'width': 3648}],\n",
      "              'place_id': 'ChIJvbGg56pZwokRp_E3JbivnLQ',\n",
      "              'plus_code': {'compound_code': 'Q238+CP New York',\n",
      "                            'global_code': '87G8Q238+CP'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJvbGg56pZwokRp_E3JbivnLQ',\n",
      "              'types': ['park',\n",
      "                        'tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 53725},\n",
      "             {'formatted_address': '99 Margaret Corbin Dr, New York, NY 10040, '\n",
      "                                   'United States',\n",
      "              'geometry': {'location': {'lat': 40.8648628, 'lng': -73.9317274},\n",
      "                           'viewport': {'northeast': {'lat': 40.86665500000001,\n",
      "                                                      'lng': -73.9246285},\n",
      "                                        'southwest': {'lat': 40.86222299999999,\n",
      "                                                      'lng': -73.93519849999998}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/museum-71.png',\n",
      "              'id': '8edf774a665aeb294a6d6cf8df4405f4824f7e4f',\n",
      "              'name': 'The Met Cloisters',\n",
      "              'opening_hours': {'open_now': False},\n",
      "              'photos': [{'height': 3456,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/110635539067309920476\">Monica '\n",
      "                                                'Ramirez</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAbHxYcvkNQYgHSVO_E3rlxOpQGXjPjkItkxPewy4Fipi5qUyB3j3DUQ-QKl_I-EOWlJv8Vjf56uaWnGs07Zjm7hI41htCxB_cIai4ElpDA25_iuxSd80wwDKy2UHV0pdxEhDjoA9BO_sjnBwSurAJmq6rGhQgYuAHA-BbAmhsVRc82Tgdzh0X2g',\n",
      "                          'width': 4608}],\n",
      "              'place_id': 'ChIJK6bycAH0wokRrSnflfrnkZE',\n",
      "              'plus_code': {'compound_code': 'V379+W8 New York',\n",
      "                            'global_code': '87G8V379+W8'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJK6bycAH0wokRrSnflfrnkZE',\n",
      "              'types': ['tourist_attraction',\n",
      "                        'museum',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 4276},\n",
      "             {'formatted_address': 'New York, NY 10012, United States',\n",
      "              'geometry': {'location': {'lat': 40.7308228, 'lng': -73.997332},\n",
      "                           'viewport': {'northeast': {'lat': 40.7333674,\n",
      "                                                      'lng': -73.99379465},\n",
      "                                        'southwest': {'lat': 40.72847220000001,\n",
      "                                                      'lng': -74.00132525}}},\n",
      "              'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/generic_recreational-71.png',\n",
      "              'id': 'b0df149329a0f6a4006cc5328e3d42acadaf1b4f',\n",
      "              'name': 'Washington Square Park',\n",
      "              'opening_hours': {'open_now': True},\n",
      "              'photos': [{'height': 3744,\n",
      "                          'html_attributions': ['<a '\n",
      "                                                'href=\"https://maps.google.com/maps/contrib/100843101132796394246\">W '\n",
      "                                                'L</a>'],\n",
      "                          'photo_reference': 'CmRaAAAAhngCoNhl39yu1EEcym598TIq4sbCW1yaXpXtsDuzlZDIrZdy1kGqNS6_briIsUA2fxuOodj6m_sN3kE-Zd8wcTaEnabyK0hqZZb3JZX9zXOUyDpsdHN0zYuk4P9G0d-XEhDVdpsuJPxHZdzTtm0mNdQIGhT73c4L2Ce5rteJyMc2n_4s8Vqhyw',\n",
      "                          'width': 4274}],\n",
      "              'place_id': 'ChIJjX494pBZwokRGH620d9eYfo',\n",
      "              'plus_code': {'compound_code': 'P2J3+83 New York',\n",
      "                            'global_code': '87G8P2J3+83'},\n",
      "              'rating': 4.7,\n",
      "              'reference': 'ChIJjX494pBZwokRGH620d9eYfo',\n",
      "              'types': ['park',\n",
      "                        'tourist_attraction',\n",
      "                        'point_of_interest',\n",
      "                        'establishment'],\n",
      "              'user_ratings_total': 17675}],\n",
      " 'status': 'OK'}\n"
     ]
    }
   ],
   "source": [
    "#Review API data\n",
    "# type(response)\n",
    "pprint(response)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "20\n"
     ]
    }
   ],
   "source": [
    "#create list from response\n",
    "\n",
    "response_list = [resp for resp in response[\"results\"]]\n",
    "print(len(response_list))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'formatted_address': '10 South St, New York, NY 10004, United States',\n",
       " 'geometry': {'location': {'lat': 40.6919879, 'lng': -74.01599499999999},\n",
       "  'viewport': {'northeast': {'lat': 40.69333772989273,\n",
       "    'lng': -74.01464517010727},\n",
       "   'southwest': {'lat': 40.69063807010728, 'lng': -74.0173448298927}}},\n",
       " 'icon': 'https://maps.gstatic.com/mapfiles/place_api/icons/museum-71.png',\n",
       " 'id': 'e2568410beb651c76959c8c706e1d771fc316fa9',\n",
       " 'name': 'Governors Island National Monument',\n",
       " 'opening_hours': {'open_now': False},\n",
       " 'photos': [{'height': 4897,\n",
       "   'html_attributions': ['<a href=\"https://maps.google.com/maps/contrib/106490258821111884682\">Mark Furmanik</a>'],\n",
       "   'photo_reference': 'CmRaAAAA4eurt9cKgbHsY02cnEneuBTiMMMShAQptuJmdsTZ6g1buh_0u09aKly11ogYgbY35e8rhHiZ0BJQSa6qfV-kPRhXjFaDIb6ts8oiSF5gG33OzjqsOysrI3yapAr7KRlYEhAHPdCFxyVI0i1kqOSHHBJ2GhQKorltsNbw1ANgCI4JVAsqFuydRQ',\n",
       "   'width': 3266}],\n",
       " 'place_id': 'ChIJ2_ey6W9awokRxng4fzLDbPo',\n",
       " 'plus_code': {'compound_code': 'MXRM+QJ New York',\n",
       "  'global_code': '87G7MXRM+QJ'},\n",
       " 'rating': 4.6,\n",
       " 'reference': 'ChIJ2_ey6W9awokRxng4fzLDbPo',\n",
       " 'types': ['tourist_attraction', 'point_of_interest', 'establishment'],\n",
       " 'user_ratings_total': 2675}"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#view on response\n",
    "\n",
    "response_list[0]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "NY\n"
     ]
    }
   ],
   "source": [
    "#Database about city sites\n",
    "city_table_df = pd.DataFrame({\n",
    "                    'city_id':['NY'],\n",
    "                    'city':['New York']})\n",
    "\n",
    "city_id = city_table_df.loc[city_table_df[\"city\"] == 'New York', \"city_id\"]\n",
    "print(city_id[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Data Retrieval Complete, Count 21\n",
      "------------------------------\n"
     ]
    }
   ],
   "source": [
    "# set up lists to hold reponse infodata = []\n",
    "cityid = []\n",
    "site_name = []\n",
    "rating = []\n",
    "rating_totals = []\n",
    "address = []\n",
    "latitude = []\n",
    "longitude = []\n",
    "count = 1\n",
    "\n",
    "# Loop through the list of cities and perform a request for data on each\n",
    "for response in response_list:\n",
    "    try:\n",
    "        cityid.append(city_id[0])\n",
    "        site_name.append(response[\"name\"])\n",
    "        rating.append(response[\"rating\"])\n",
    "        rating_totals.append(response[\"user_ratings_total\"])\n",
    "        address.append(response[\"formatted_address\"])\n",
    "        latitude.append(response[\"geometry\"][\"location\"][\"lat\"])\n",
    "        longitude.append(response[\"geometry\"][\"location\"][\"lng\"])\n",
    "        count = count + 1\n",
    "    except KeyError:\n",
    "        print(f'City Site not found. Skipping... {site_name}')\n",
    "\n",
    "print('------------------------------')\n",
    "print(f'Data Retrieval Complete, Count {count}')\n",
    "print('------------------------------')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "city_id          20\n",
       "site_name        20\n",
       "rating           20\n",
       "rating_totals    20\n",
       "address          20\n",
       "latitude         20\n",
       "longitude        20\n",
       "dtype: int64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_data = pd.DataFrame({\"city_id\": cityid,\n",
    "                            \"site_name\": site_name,\n",
    "                            \"rating\": rating,\n",
    "                            \"rating_totals\": rating_totals,\n",
    "                            \"address\": address,\n",
    "                            \"latitude\": latitude,\n",
    "                            \"longitude\": longitude})\n",
    "#Save DF as csv\n",
    "\n",
    "city_data.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>rating</th>\n",
       "      <th>rating_totals</th>\n",
       "      <th>address</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NY</td>\n",
       "      <td>Governors Island National Monument</td>\n",
       "      <td>4.6</td>\n",
       "      <td>2675</td>\n",
       "      <td>10 South St, New York, NY 10004</td>\n",
       "      <td>40.691988</td>\n",
       "      <td>-74.015995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NY</td>\n",
       "      <td>General Grant National Memorial</td>\n",
       "      <td>4.5</td>\n",
       "      <td>697</td>\n",
       "      <td>W 122nd St &amp; Riverside Dr, New York, NY 10027</td>\n",
       "      <td>40.813404</td>\n",
       "      <td>-73.963067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NY</td>\n",
       "      <td>Alexander Hamilton Grange National Memorial</td>\n",
       "      <td>4.5</td>\n",
       "      <td>529</td>\n",
       "      <td>414 W 141st St, New York, NY 10031</td>\n",
       "      <td>40.821354</td>\n",
       "      <td>-73.947310</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NY</td>\n",
       "      <td>Statue of Liberty National Monument</td>\n",
       "      <td>4.7</td>\n",
       "      <td>66920</td>\n",
       "      <td>New York, NY 10004</td>\n",
       "      <td>40.689249</td>\n",
       "      <td>-74.044500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NY</td>\n",
       "      <td>Grand Central Market</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1060</td>\n",
       "      <td>89 E 42nd St, New York, NY 10017</td>\n",
       "      <td>40.752594</td>\n",
       "      <td>-73.976728</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  city_id                                    site_name  rating  rating_totals  \\\n",
       "0      NY           Governors Island National Monument     4.6           2675   \n",
       "1      NY              General Grant National Memorial     4.5            697   \n",
       "2      NY  Alexander Hamilton Grange National Memorial     4.5            529   \n",
       "3      NY          Statue of Liberty National Monument     4.7          66920   \n",
       "4      NY                         Grand Central Market     4.5           1060   \n",
       "\n",
       "                                         address   latitude  longitude  \n",
       "0                10 South St, New York, NY 10004  40.691988 -74.015995  \n",
       "1  W 122nd St & Riverside Dr, New York, NY 10027  40.813404 -73.963067  \n",
       "2             414 W 141st St, New York, NY 10031  40.821354 -73.947310  \n",
       "3                             New York, NY 10004  40.689249 -74.044500  \n",
       "4               89 E 42nd St, New York, NY 10017  40.752594 -73.976728  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Clean Data \n",
    "city_data[\"address\"] = city_data[\"address\"].str.replace(\", United States\", \"\", case = False) \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Database Section \n",
    "     *Create a PostgreSQL database:  airbnb_db\n",
    "     *Create tables using schema.sql file within PostgreSQL\n",
    "     *Based on city_data dataframe, and city_table dataframe. \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Connect to local database\n",
    "pg_user = 'postgres'\n",
    "pg_password = 'gracem10'\n",
    "db_name = 'airbnb_db'\n",
    "\n",
    "connection_string = f\"{pg_user}:{pg_password}@localhost:5432/{db_name}\"\n",
    "engine = create_engine(f'postgresql://{connection_string}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['city_table', 'city_sites']"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Check for tables\n",
    "engine.table_names()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Use pandas to load data frome into database\n",
    "city_table_df.to_sql(name='city_table', con=engine, if_exists='append', index=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Use pandas to load data frome into database\n",
    "city_data.to_sql(name='city_sites', con=engine, if_exists='append', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>city_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>rating</th>\n",
       "      <th>rating_totals</th>\n",
       "      <th>address</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>NY</td>\n",
       "      <td>Governors Island National Monument</td>\n",
       "      <td>4.6</td>\n",
       "      <td>2675</td>\n",
       "      <td>10 South St, New York, NY 10004</td>\n",
       "      <td>40.691988</td>\n",
       "      <td>-74.015995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>NY</td>\n",
       "      <td>General Grant National Memorial</td>\n",
       "      <td>4.5</td>\n",
       "      <td>697</td>\n",
       "      <td>W 122nd St &amp; Riverside Dr, New York, NY 10027</td>\n",
       "      <td>40.813404</td>\n",
       "      <td>-73.963067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>NY</td>\n",
       "      <td>Alexander Hamilton Grange National Memorial</td>\n",
       "      <td>4.5</td>\n",
       "      <td>529</td>\n",
       "      <td>414 W 141st St, New York, NY 10031</td>\n",
       "      <td>40.821354</td>\n",
       "      <td>-73.947310</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>NY</td>\n",
       "      <td>Statue of Liberty National Monument</td>\n",
       "      <td>4.7</td>\n",
       "      <td>66920</td>\n",
       "      <td>New York, NY 10004</td>\n",
       "      <td>40.689249</td>\n",
       "      <td>-74.044500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>NY</td>\n",
       "      <td>Grand Central Market</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1060</td>\n",
       "      <td>89 E 42nd St, New York, NY 10017</td>\n",
       "      <td>40.752594</td>\n",
       "      <td>-73.976728</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>NY</td>\n",
       "      <td>SeaGlass Carousel</td>\n",
       "      <td>4.5</td>\n",
       "      <td>497</td>\n",
       "      <td>Water St &amp;, State St, New York, NY 10004</td>\n",
       "      <td>40.702181</td>\n",
       "      <td>-74.014997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>NY</td>\n",
       "      <td>Central Park</td>\n",
       "      <td>4.8</td>\n",
       "      <td>194571</td>\n",
       "      <td>New York, NY</td>\n",
       "      <td>40.782865</td>\n",
       "      <td>-73.965355</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>NY</td>\n",
       "      <td>Empire State Building</td>\n",
       "      <td>4.7</td>\n",
       "      <td>70860</td>\n",
       "      <td>20 W 34th St, New York, NY 10001</td>\n",
       "      <td>40.748441</td>\n",
       "      <td>-73.985664</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>NY</td>\n",
       "      <td>Brooklyn Bridge</td>\n",
       "      <td>4.8</td>\n",
       "      <td>43973</td>\n",
       "      <td>Brooklyn Bridge, New York, NY 10038</td>\n",
       "      <td>40.706086</td>\n",
       "      <td>-73.996864</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>NY</td>\n",
       "      <td>The High Line</td>\n",
       "      <td>4.7</td>\n",
       "      <td>38797</td>\n",
       "      <td>New York, NY 10011</td>\n",
       "      <td>40.747993</td>\n",
       "      <td>-74.004765</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>NY</td>\n",
       "      <td>St. Patrick's Cathedral</td>\n",
       "      <td>4.8</td>\n",
       "      <td>24222</td>\n",
       "      <td>5th Ave, New York, NY 10022</td>\n",
       "      <td>40.758465</td>\n",
       "      <td>-73.975993</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>NY</td>\n",
       "      <td>Top of the Rock</td>\n",
       "      <td>4.7</td>\n",
       "      <td>34969</td>\n",
       "      <td>30 Rockefeller Plaza, New York, NY 10112</td>\n",
       "      <td>40.759121</td>\n",
       "      <td>-73.979527</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>NY</td>\n",
       "      <td>Rockefeller Center</td>\n",
       "      <td>4.6</td>\n",
       "      <td>115783</td>\n",
       "      <td>45 Rockefeller Plaza, New York, NY 10111</td>\n",
       "      <td>40.758740</td>\n",
       "      <td>-73.978674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>NY</td>\n",
       "      <td>The Metropolitan Museum of Art</td>\n",
       "      <td>4.8</td>\n",
       "      <td>55252</td>\n",
       "      <td>1000 5th Ave, New York, NY 10028</td>\n",
       "      <td>40.779437</td>\n",
       "      <td>-73.963244</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>NY</td>\n",
       "      <td>Intrepid Sea, Air &amp; Space Museum</td>\n",
       "      <td>4.6</td>\n",
       "      <td>26027</td>\n",
       "      <td>Pier 86, W 46th St, New York, NY 10036</td>\n",
       "      <td>40.764527</td>\n",
       "      <td>-73.999608</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>NY</td>\n",
       "      <td>One World Observatory</td>\n",
       "      <td>4.7</td>\n",
       "      <td>13670</td>\n",
       "      <td>285 Fulton St, New York, NY 10006</td>\n",
       "      <td>40.713344</td>\n",
       "      <td>-74.013368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>NY</td>\n",
       "      <td>Radio City Music Hall</td>\n",
       "      <td>4.7</td>\n",
       "      <td>16414</td>\n",
       "      <td>1260 6th Ave, New York, NY 10020</td>\n",
       "      <td>40.759976</td>\n",
       "      <td>-73.979977</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>NY</td>\n",
       "      <td>Bryant Park</td>\n",
       "      <td>4.7</td>\n",
       "      <td>53725</td>\n",
       "      <td>New York, NY 10018</td>\n",
       "      <td>40.753597</td>\n",
       "      <td>-73.983233</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>NY</td>\n",
       "      <td>The Met Cloisters</td>\n",
       "      <td>4.7</td>\n",
       "      <td>4276</td>\n",
       "      <td>99 Margaret Corbin Dr, New York, NY 10040</td>\n",
       "      <td>40.864863</td>\n",
       "      <td>-73.931727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>NY</td>\n",
       "      <td>Washington Square Park</td>\n",
       "      <td>4.7</td>\n",
       "      <td>17675</td>\n",
       "      <td>New York, NY 10012</td>\n",
       "      <td>40.730823</td>\n",
       "      <td>-73.997332</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    id city_id                                    site_name  rating  \\\n",
       "0    1      NY           Governors Island National Monument     4.6   \n",
       "1    2      NY              General Grant National Memorial     4.5   \n",
       "2    3      NY  Alexander Hamilton Grange National Memorial     4.5   \n",
       "3    4      NY          Statue of Liberty National Monument     4.7   \n",
       "4    5      NY                         Grand Central Market     4.5   \n",
       "5    6      NY                            SeaGlass Carousel     4.5   \n",
       "6    7      NY                                 Central Park     4.8   \n",
       "7    8      NY                        Empire State Building     4.7   \n",
       "8    9      NY                              Brooklyn Bridge     4.8   \n",
       "9   10      NY                                The High Line     4.7   \n",
       "10  11      NY                      St. Patrick's Cathedral     4.8   \n",
       "11  12      NY                              Top of the Rock     4.7   \n",
       "12  13      NY                           Rockefeller Center     4.6   \n",
       "13  14      NY               The Metropolitan Museum of Art     4.8   \n",
       "14  15      NY             Intrepid Sea, Air & Space Museum     4.6   \n",
       "15  16      NY                        One World Observatory     4.7   \n",
       "16  17      NY                        Radio City Music Hall     4.7   \n",
       "17  18      NY                                  Bryant Park     4.7   \n",
       "18  19      NY                            The Met Cloisters     4.7   \n",
       "19  20      NY                       Washington Square Park     4.7   \n",
       "\n",
       "    rating_totals                                        address   latitude  \\\n",
       "0            2675                10 South St, New York, NY 10004  40.691988   \n",
       "1             697  W 122nd St & Riverside Dr, New York, NY 10027  40.813404   \n",
       "2             529             414 W 141st St, New York, NY 10031  40.821354   \n",
       "3           66920                             New York, NY 10004  40.689249   \n",
       "4            1060               89 E 42nd St, New York, NY 10017  40.752594   \n",
       "5             497       Water St &, State St, New York, NY 10004  40.702181   \n",
       "6          194571                                   New York, NY  40.782865   \n",
       "7           70860               20 W 34th St, New York, NY 10001  40.748441   \n",
       "8           43973            Brooklyn Bridge, New York, NY 10038  40.706086   \n",
       "9           38797                             New York, NY 10011  40.747993   \n",
       "10          24222                    5th Ave, New York, NY 10022  40.758465   \n",
       "11          34969       30 Rockefeller Plaza, New York, NY 10112  40.759121   \n",
       "12         115783       45 Rockefeller Plaza, New York, NY 10111  40.758740   \n",
       "13          55252               1000 5th Ave, New York, NY 10028  40.779437   \n",
       "14          26027         Pier 86, W 46th St, New York, NY 10036  40.764527   \n",
       "15          13670              285 Fulton St, New York, NY 10006  40.713344   \n",
       "16          16414               1260 6th Ave, New York, NY 10020  40.759976   \n",
       "17          53725                             New York, NY 10018  40.753597   \n",
       "18           4276      99 Margaret Corbin Dr, New York, NY 10040  40.864863   \n",
       "19          17675                             New York, NY 10012  40.730823   \n",
       "\n",
       "    longitude  \n",
       "0  -74.015995  \n",
       "1  -73.963067  \n",
       "2  -73.947310  \n",
       "3  -74.044500  \n",
       "4  -73.976728  \n",
       "5  -74.014997  \n",
       "6  -73.965355  \n",
       "7  -73.985664  \n",
       "8  -73.996864  \n",
       "9  -74.004765  \n",
       "10 -73.975993  \n",
       "11 -73.979527  \n",
       "12 -73.978674  \n",
       "13 -73.963244  \n",
       "14 -73.999608  \n",
       "15 -74.013368  \n",
       "16 -73.979977  \n",
       "17 -73.983233  \n",
       "18 -73.931727  \n",
       "19 -73.997332  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Confirm data has been added by querying the table\n",
    "pd.read_sql_query('select * from city_sites', con=engine).head(25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city_id</th>\n",
       "      <th>city</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NY</td>\n",
       "      <td>New York</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  city_id      city\n",
       "0      NY  New York"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql_query('select * from city_table', con=engine).head(25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernel_info": {
   "name": "python3"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  },
  "nteract": {
   "version": "0.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
